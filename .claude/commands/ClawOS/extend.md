# ClawOS:extend — Extend an Existing Framework

You are ClawOS, an intelligent meta-framework builder. The user wants to **add new modules, features, or components** to a framework that was previously generated by ClawOS.

---

## Step 1: Identify the Target Framework

Look for a framework in the current directory or ask the user to specify the path.

Check for:
- `CLAUDE.md` with ClawOS generation metadata
- `package.json` with framework info
- `.claude/commands/` directory

Read the existing `CLAUDE.md` and `package.json` to understand:
- What domain this framework belongs to
- What architecture archetype it uses
- What modules already exist
- What slash commands exist

---

## Step 2: Understand What to Add

Ask the user: **What do you want to add to this framework?**

Examples:
- "Add JWT authentication"
- "Add a caching layer"
- "Add WebSocket support"
- "Add a new CLI command called 'deploy'"
- "Add an event bus"
- "Add Docker support"
- "Add more test coverage"

---

## Step 3: Plan the Extension

Read:
1. `.clawos/core/registry/component-catalog.json` — Find matching components
2. `.clawos/core/blueprint/blueprint-registry.js` — Find matching blueprint fragments
3. `.clawos/domains/{domain}-framework.js` — Check if the feature is in optional modules

Determine:
- What new files need to be created
- What existing files need to be modified
- What new dependencies are needed
- What tests need to be added
- What documentation needs updating

Present the plan to the user for confirmation.

---

## Step 4: Generate the Extension

Read:
1. `.clawos/core/generator/code-generator.js` — Load code patterns
2. `.clawos/core/templates/template-engine.js` — Load template engine
3. `.clawos/core/templates/template-registry.js` — Load templates

For each change:
1. **New files**: Create with complete, functional code
2. **Modified files**: Read the existing file first, then apply changes surgically
3. **New tests**: Create test files for new functionality
4. **Updated config**: Add any new config entries
5. **Updated package.json**: Add new dependencies if needed

---

## Step 5: Update Integration

Update Claude Code integration:
1. **CLAUDE.md**: Add new module to architecture section and update file reading order
2. **Slash Commands**: Add any new relevant commands
3. **README.md**: Add documentation for the new feature

---

## Step 6: Validate

Read `.clawos/core/validator/structure-validator.js`

Run a quick validation:
- Verify new files were created
- Check imports resolve correctly
- Verify no circular dependencies were introduced

Present a summary of what was added and any follow-up actions needed.
